#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue Jul 23 10:42:17 2024

@author: charmainechia
"""

def sort_list(lst):
    lst.sort()
    return lst

def dict_update(d, keyval):
    d.update(keyval)
    return d

# data folder
data_folder = '../ajino-analytics-data/'
# figure fodler
figure_folder = f'{data_folder}figures/'

sampling_rawdata_dict = {
    0: {'fname': '240402_20RP06-19_data for Astar_4conditions_v2.xlsx', 'skiprows':[2,2,2,2,2,None,2,1], 'usecols':['B:CA', 'B:DR', 'B:BE', 'B:BE', 'B:AZ', None, 'B:AI', 'A:F'], 'cqa_startcol':[6,6,6,6,6, None,2,1], },
    1: {'fname': '240906_22DX05-12_media combination_AJI-Astar_v2.xlsx', 'skiprows':[2,2,2,2,2,2,2,2], 'usecols':['B:BH', 'B:FN', 'B:CA', 'B:CA', 'B:BT', 'B:AK', 'B:GM', 'B:J'], 'cqa_startcol':[8,8,8,8,8,8,2,1], },
    2: {'fname': '240906_22DX05-12_process combination_AJI-Astar_v3.xlsx', 'skiprows':[2,2,2,2,2,2,2,2], 'usecols':['B:BF', 'B:FN', 'B:CA', 'B:CA', 'B:BT', 'B:AK', 'B:GM', 'B:D'], 'cqa_startcol':[8,8,8,8,8,8,2,1], },
    }

media_rawdata_dict = {
    0: {'fname': '240402_20RP06-19_data for Astar_4conditions_v2.xlsx', 'skiprows':1, 'usecols':'A:F', 'cqa_startcol':1, },
    1: {'fname': '240906_22DX05-12_media combination_AJI-Astar_v2.xlsx', 'skiprows':2, 'usecols':'B:J', 'cqa_startcol':1, },
    2: {'fname': '240906_22DX05-12_process combination_AJI-Astar_v3.xlsx', 'skiprows':2, 'usecols':'B:D', 'cqa_startcol':1, },
    }

sampling_days = {
    0: [0,3,5,7,9,11,13,14],
    1: [0,3,5,7,9,11,14],
    2: [0,3,5,7,9,11,14],
    }

sampling_days_itpl = {
    0: [0,1,2,3,4,5,6,7,9,11,13,14],
    1: [0,3,5,7,9,11,14],
    2: [0,3,5,7,9,11,14],
    }

vol_df_exp_cols = [
    'Day',
    'event',
    'time (d)',
    'time (m)',
    'vessel volume (mL)',
    'feed (mL)',
    'glucose (mL)'
 ]


var_dict_all = {
    'inputs': [
        'Basal medium',
        'Feed medium',
        'DO',
        'pH',
        'feed %',
        'feed day',
        'feed vol',
        ],
    'VCD, VIA, Titer, metabolites': [
        'VCD (E6 cells/mL)',
        'Viability (%)',
        'Titer (mg/L)',
        'Osmolarity (mOsm/kg)',
        'Glucose (g/L)',
        'Lac (g/L)',
        'NH4+ (mM)'
        ],
    'AA': [
        'Ala',
        'Arg',
        'Asn',
        'Asp',
        'Gln',
        'Glu',
        'Gly',
        'Gly-Tyr',
        'His',
        'HyPro',
        'Ile',
        'Leu',
        'Lys',
        'Met',
        'Orn',
        'Phe',
        'Pro',
        'Ser',
        'Tau',
        'Thr',
        'Trp',
        'Tyr',
        'Val'
        ],
    'VT': [
        'Choline',
        'Thiamin',
        'Pyridoxal',
        'Pyridoxine',
        'Nicotinamide',
        'Pantothenic  acid',
        'Folic acid',
        'Cyanocobalamin',
        'Riboflavin',
        'Biotin'
        ],
    'MT': [
        'Na', 
        'Mg', 
        'P', 
        'K', 
        'Ca', 
        'Fe', 
        'Co', 
        'Cu', 
        'Zn', 
        'Mn'
        ],
    'Glyco': [
        'Man5', 
        'G0', 
        'G0F', 
        'G1', 
        'G1Fa', 
        'G1Fb', 
        'G2', 
        'G2F', 
        'Other'
        ],
    'Nuc, Amine': [
        'Ethanolamine', 
        'Putrescine', 
        'Uridine', 
        'Adenosine'
        ], 
    'media_components': [
        'Ala',
        'Arg',
        'Asn',
        'Asp',
        'Glu',
        'Gly',
        'Gly-Tyr',
        'His',
        'HyPro',
        'Ile',
        'Leu',
        'Lys',
        'Met',
        'Orn',
        'Phe',
        'Pro',
        'Ser',
        'Tau',
        'Thr',
        'Trp',
        'Tyr',
        'Val',
        'Choline',
        'Thiamin',
        'Pyridoxal',
        'Pyridoxine',
        'Nicotinamide',
        'Pantothenic  acid',
        'Folic acid',
        'Cyanocobalamin',
        'Riboflavin',
        'Biotin',
        'Na',
        'Mg',
        'P',
        'K',
        'Ca',
        'Fe',
        'Co',
        'Cu',
        'Zn',
        'Mn',
        'D-glucose'
     ]
    }

overall_glyco_cqas = {
    'mannosylation': ['Man5'],
    'fucosylation': ['G0F', 'G1Fa', 'G1Fb', 'G2F'],
    'galactosylation': ['G0', 'G0F', 'G1', 'G1Fa', 'G1Fb', 'G2', 'G2F']
    }

nutrients_calculated_list = [
    'Arg',
    'Asn',
    'Asp',
    'Glu',
    'Gly-Tyr',
    'His',
    'Ile',
    'Leu',
    'Lys',
    'Met',
    'Phe',
    'Pro',
    'Ser',
    'Tau',
    'Thr',
    'Trp',
    'Val',
    'Choline',
    'Thiamin',
    'Nicotinamide',
    'Pantothenic  acid',
    'Folic acid',
    'Cyanocobalamin',
    'Riboflavin',
    'Biotin',
    'Na',
    'Mg',
    'P',
    'K',
    'Ca',
    'Fe',
    'Co',
    'Cu',
    'Zn',
    'Mn',
    # 'Glucose (g/L)',
    'Pyridoxine',
    'Tyr',
    'Uridine',
    'Ala',
    'Ethanolamine'
 ]
#%% X % Y DATASET VARIABLES
xvar_list_dict_prefilt = {
0: ['Adenosine_0',
  'Ala_0',
  'Arg_0',
  'Asn_0',
  'Asp_0',
  'Biotin_0',
  'Ca_0',
  'Choline_0',
  'Co_0',
  'Cu_0',
  'Cyanocobalamin_0',
  'Ethanolamine_0',
  'Fe_0',
  'Folic acid_0',
  'Gln_0',
  'Glu_0',
  'Glucose (g/L)_0',
  'Gly-Tyr_0',
  'Gly_0',
  'His_0',
  'HyPro_0',
  'Ile_0',
  'K_0',
  'Leu_0',
  'Lys_0',
  'Met_0',
  'Mg_0',
  'Mn_0',
  'Na_0',
  'Nicotinamide_0',
  'Orn_0',
  'P_0',
  'Pantothenic  acid_0',
  'Phe_0',
  'Pro_0',
  'Putrescine_0',
  'Pyridoxal_0',
  'Pyridoxine_0',
  'Riboflavin_0',
  'Ser_0',
  'Tau_0',
  'Thiamin_0',
  'Thr_0',
  'Trp_0',
  'Tyr_0',
  'Uridine_0',
  'Val_0',
  'Zn_0',
  'DO',
  'pH',
  'feed %',
  # 'feed vol',
  ],
1: ['Arg_basal',
 'Asn_basal',
 'Asp_basal',
 'Biotin_basal',
 'Ca_basal',
 'Choline_basal',
 'Co_basal',
 'Cu_basal',
 'Cyanocobalamin_basal',
 'D-glucose_basal',
 'Fe_basal',
 'Folic acid_basal',
 'Glu_basal',
 'His_basal',
 'Ile_basal',
 'K_basal',
 'Leu_basal',
 'Lys_basal',
 'Met_basal',
 'Mg_basal',
 'Na_basal',
 'Nicotinamide_basal',
 'Orn_basal',
 'P_basal',
 'Pantothenic  acid_basal',
 'Phe_basal',
 'Pro_basal',
 'Pyridoxine_basal',
 'Riboflavin_basal',
 'Ser_basal',
 'Thr_basal',
 'Trp_basal',
 'Tyr_basal',
 'Val_basal',
 'Zn_basal',
 'Arg_feed',
 'Asn_feed',
 'Asp_feed',
 'Biotin_feed',
 'Ca_feed',
 'Choline_feed',
 'Co_feed',
 'Cu_feed',
 'Cyanocobalamin_feed',
 'D-glucose_feed',
 'Fe_feed',
 'Folic acid_feed',
 'Glu_feed',
 'Gly-Tyr_feed',
 'His_feed',
 'Ile_feed',
 'K_feed',
 'Leu_feed',
 'Lys_feed',
 'Met_feed',
 'Mg_feed',
 'Mn_feed',
 'Na_feed',
 'Nicotinamide_feed',
 'P_feed',
 'Pantothenic  acid_feed',
 'Phe_feed',
 'Pro_feed',
 'Pyridoxine_feed',
 'Riboflavin_feed',
 'Ser_feed',
 'Thr_feed',
 'Trp_feed',
 'Val_feed',
 'Zn_feed',
 'DO',
 'pH',
 'feed %',
  'feed vol',
 ],

2: ['Arg_basal',
 'Asn_basal',
 'Asp_basal',
 'Biotin_basal',
 'Ca_basal',
 'Choline_basal',
 'Co_basal',
 'Cu_basal',
 'Cyanocobalamin_basal',
 'D-glucose_basal',
 'Fe_basal',
 'Folic acid_basal',
 'Glu_basal',
 'His_basal',
 'Ile_basal',
 'K_basal',
 'Leu_basal',
 'Lys_basal',
 'Met_basal',
 'Mg_basal',
 'Na_basal',
 'Nicotinamide_basal',
 'Orn_basal',
 'P_basal',
 'Pantothenic  acid_basal',
 'Phe_basal',
 'Pro_basal',
 'Pyridoxine_basal',
 'Riboflavin_basal',
 'Ser_basal',
 'Thr_basal',
 'Trp_basal',
 'Tyr_basal',
 'Val_basal',
 'Zn_basal',
 'Arg_feed',
 'Asn_feed',
 'Asp_feed',
 'Biotin_feed',
 'Ca_feed',
 'Choline_feed',
 'Co_feed',
 'Cu_feed',
 'Cyanocobalamin_feed',
 'D-glucose_feed',
 'Fe_feed',
 'Folic acid_feed',
 'Glu_feed',
 'Gly-Tyr_feed',
 'His_feed',
 'Ile_feed',
 'K_feed',
 'Leu_feed',
 'Lys_feed',
 'Met_feed',
 'Mg_feed',
 'Mn_feed',
 'Na_feed',
 'Nicotinamide_feed',
 'P_feed',
 'Pantothenic  acid_feed',
 'Phe_feed',
 'Pro_feed',
 'Pyridoxine_feed',
 'Riboflavin_feed',
 'Ser_feed',
 'Thr_feed',
 'Trp_feed',
 'Val_feed',
 'Zn_feed',
 ]
}

#%%

xvar_list_dict = {
0: ['Ala_0',
 'Arg_0',
 'Asn_0',
 'Asp_0',
 'Biotin_0',
 'Ca_0',
 'Choline_0',
 'Co_0',
 'Cu_0',
 'Cyanocobalamin_0',
 'Ethanolamine_0',
 'Fe_0',
 'Folic acid_0',
 'Gln_0',
 'Glu_0',
 'Glucose (g/L)_0',
 'Gly_0',
 'His_0',
 'HyPro_0',
 'Ile_0',
 'K_0',
 'Leu_0',
 'Lys_0',
 'Met_0',
 'Mg_0',
 'Mn_0',
 'Na_0',
 'Nicotinamide_0',
 'Orn_0',
 'P_0',
 'Pantothenic  acid_0',
 'Phe_0',
 'Pro_0',
 'Pyridoxal_0',
 'Pyridoxine_0',
 'Riboflavin_0',
 'Ser_0',
 'Tau_0',
 'Thr_0',
 'Trp_0',
 'Tyr_0',
 'Val_0',
 'Zn_0',
 'DO',
 'pH',
 'feed %',
 # 'feed vol',
 ],

1: ['Arg_basal',
 'Asn_basal',
 'Asp_basal',
 'Biotin_basal',
 'Ca_basal',
 'Choline_basal',
 'Co_basal',
 'Cu_basal',
 'Cyanocobalamin_basal',
 'D-glucose_basal',
 'Fe_basal',
 'Folic acid_basal',
 'Glu_basal',
 'His_basal',
 'Ile_basal',
 'K_basal',
 'Leu_basal',
 'Lys_basal',
 'Met_basal',
 'Mg_basal',
 'Na_basal',
 'Nicotinamide_basal',
 'Orn_basal',
 'P_basal',
 'Pantothenic  acid_basal',
 'Phe_basal',
 'Pro_basal',
 'Pyridoxine_basal',
 'Riboflavin_basal',
 'Ser_basal',
 'Thr_basal',
 'Trp_basal',
 'Tyr_basal',
 'Val_basal',
 'Zn_basal',
 'Arg_feed',
 'Asn_feed',
 'Asp_feed',
 'Biotin_feed',
 'Ca_feed',
 'Choline_feed',
 'Co_feed',
 'Cu_feed',
 'Cyanocobalamin_feed',
 'D-glucose_feed',
 'Fe_feed',
 'Folic acid_feed',
 'Glu_feed',
 'Gly-Tyr_feed',
 'His_feed',
 'Ile_feed',
 'K_feed',
 'Leu_feed',
 'Lys_feed',
 'Met_feed',
 'Mg_feed',
 'Mn_feed',
 'Na_feed',
 'Nicotinamide_feed',
 'P_feed',
 'Pantothenic  acid_feed',
 'Phe_feed',
 'Pro_feed',
 'Pyridoxine_feed',
 'Riboflavin_feed',
 'Ser_feed',
 'Thr_feed',
 'Trp_feed',
 'Val_feed',
 'Zn_feed',
 'DO',
 'pH',
 'feed %',
  'feed vol',
 ],

2: ['Arg_basal',
 'Asn_basal',
 'Asp_basal',
 'Biotin_basal',
 'Ca_basal',
 'Choline_basal',
 'Co_basal',
 'Cu_basal',
 'Cyanocobalamin_basal',
 'D-glucose_basal',
 'Fe_basal',
 'Folic acid_basal',
 'Glu_basal',
 'His_basal',
 'Ile_basal',
 'K_basal',
 'Leu_basal',
 'Lys_basal',
 'Met_basal',
 'Mg_basal',
 'Na_basal',
 'Nicotinamide_basal',
 'Orn_basal',
 'P_basal',
 'Pantothenic  acid_basal',
 'Phe_basal',
 'Pro_basal',
 'Pyridoxine_basal',
 'Riboflavin_basal',
 'Ser_basal',
 'Thr_basal',
 'Trp_basal',
 'Tyr_basal',
 'Val_basal',
 'Zn_basal',
 'Arg_feed',
 'Asn_feed',
 'Asp_feed',
 'Biotin_feed',
 'Ca_feed',
 'Choline_feed',
 'Co_feed',
 'Cu_feed',
 'Cyanocobalamin_feed',
 'D-glucose_feed',
 'Fe_feed',
 'Folic acid_feed',
 'Glu_feed',
 'Gly-Tyr_feed',
 'His_feed',
 'Ile_feed',
 'K_feed',
 'Leu_feed',
 'Lys_feed',
 'Met_feed',
 'Mg_feed',
 'Mn_feed',
 'Na_feed',
 'Nicotinamide_feed',
 'P_feed',
 'Pantothenic  acid_feed',
 'Phe_feed',
 'Pro_feed',
 'Pyridoxine_feed',
 'Riboflavin_feed',
 'Ser_feed',
 'Thr_feed',
 'Trp_feed',
 'Val_feed',
 'Zn_feed',
 'DO',
 'pH',
 'feed %',
 ],
}


xvar_sublist_sets_bymodeltype = {
    'Titer (mg/L)_14': {
        'randomforest': {
            '_fs1': ['pH', 'Pantothenic  acid_basal', 'Cu_feed', 'D-glucose_feed', 'DO', 'Ca_basal', 'Riboflavin_feed', 'Zn_basal', 'feed %', 'Thr_feed', 'K_basal', 'His_feed', 'Na_feed', 'feed vol', 'His_basal', 'Folic acid_feed', 'Fe_basal'],
            '_sfs': ['Biotin_feed',
                'feed vol',
                'Fe_basal',
                'DO',
                'Zn_feed',
                'Asn_basal',
                'Na_basal',
                'Lys_feed',
                'pH',
                'feed %',
                'Val_feed',
                'K_feed',
                'Trp_feed',
                'Pro_basal',
                'Arg_basal',
                'Mg_feed',
                'Asp_basal',
                'Zn_basal',
                'Ser_feed',
                'Glu_feed'],
            }
        ,
        'plsr': {
            '_sfs': ['Choline_feed',
            'Cyanocobalamin_basal',
            'feed %',
            'Co_basal',
            'His_basal',
            'DO',
            'pH',
            'Folic acid_feed',
            'Riboflavin_feed',
            'Met_feed',
            'feed vol',
            'P_feed',
            'Pro_feed',
            'His_feed',
            'Pyridoxine_basal',
            'K_feed']},
        
        'lasso': {
            '_fs1': ['pH', 'Pantothenic  acid_basal', 'Cu_feed', 'D-glucose_feed', 'DO', 'Ca_basal', 'Riboflavin_feed', 'Zn_basal', 'feed %', 'Thr_feed', 'K_basal', 'His_feed', 'Na_feed', 'feed vol', 'His_basal', 'Folic acid_feed', 'Fe_basal'],
            }
        },
        
    'mannosylation_14': {
        'randomforest': {
            '_fs1': ['pH', 'Pantothenic  acid_basal', 'Cu_feed', 'D-glucose_feed', 'DO', 'Ca_basal', 'Riboflavin_feed', 'Zn_basal', 'feed %', 'Thr_feed', 'K_basal', 'His_feed', 'Na_feed', 'feed vol', 'His_basal', 'Folic acid_feed', 'Fe_basal'],
            '_sfs': ['feed vol',
              'Pantothenic  acid_feed',
              'Folic acid_basal',
              'DO',
              'Leu_feed',
              'Ile_basal',
              'P_feed',
              'Fe_feed',
              'D-glucose_basal'],
            },
        'plsr': {
            '_sfs': ['Riboflavin_basal',
          'Riboflavin_feed',
          'feed %',
          'Leu_feed',
          'Choline_basal',
          'Na_feed',
          'pH',
          'DO',
          'Pro_basal',
          'feed vol',
          'Thr_feed',
          'Ca_basal',
          'His_feed',
          'Biotin_basal']},
        
        'lasso': {      
            '_fs1': ['pH', 'feed vol', 'feed %', 'Thr_feed', 'Riboflavin_feed', 'Riboflavin_basal', 'Na_feed', 'DO', 'Cu_feed', 'Asp_basal', 'His_feed', 'Tyr_basal', 'Orn_basal', 'K_feed', 'Folic acid_basal', 'Val_basal'],
            }
        },
        
    'fucosylation_14': {
        'randomforest': {
            '_fs1': ['pH', 'Pantothenic  acid_basal', 'Cu_feed', 'D-glucose_feed', 'DO', 'Ca_basal', 'Riboflavin_feed', 'Zn_basal', 'feed %', 'Thr_feed', 'K_basal', 'His_feed', 'Na_feed', 'feed vol', 'His_basal', 'Folic acid_feed', 'Fe_basal'],
            '_sfs': ['feed vol',
              'Mg_feed',
              'Zn_basal',
              'DO',
              'Cyanocobalamin_feed',
              'Nicotinamide_basal',
              'pH',
              'Arg_basal',
              'Asn_basal',
              'Asp_basal',
              'Biotin_basal',
              'Ca_basal',
              'Choline_basal',
              'Co_basal',
              'Biotin_feed',
              'Cu_basal',
              'Cyanocobalamin_basal',
              'D-glucose_basal',
              'Fe_basal',
              'Folic acid_basal',
              'Glu_basal',
              'His_basal',
              'Ile_basal',
              'K_basal',
              'Leu_basal',
              'Lys_basal',
              'Met_basal',
              'Folic acid_feed',
              'Fe_feed',
              'Mg_basal',
              'Gly-Tyr_feed',
              'D-glucose_feed',
              'Arg_feed',
              'feed %',
              'His_feed',
              'Na_basal',
              'Ile_feed']
            },
        'plsr': {
            '_sfs': ['Riboflavin_basal',
          'Riboflavin_feed',
          'Fe_feed',
          'His_basal',
          'feed %',
          'pH',
          'DO',
          'Pantothenic  acid_basal',
          'Trp_feed',
          'feed vol',
          'K_feed',
          'Leu_feed',
          'Zn_basal',
          'Arg_basal',
          'Asn_basal',
          'Ile_basal',
          'Mg_feed',
          'D-glucose_feed',
          'Arg_feed',
          'Val_basal',
          'Biotin_feed',
          'His_feed',
          'Val_feed',
          'Lys_feed',
          'Ser_feed',
          'Phe_feed',
          'Na_feed',
          'Mg_basal',
          'Tyr_basal',
          'Cu_basal',
          'Pyridoxine_basal',
          'Pro_feed',
          'Folic acid_feed']},
        'lasso': {
            '_fs1': ['pH', 'feed vol', 'feed %', 'Tyr_basal', 'Riboflavin_feed', 'Riboflavin_basal', 'Na_feed', 'DO', 'Cu_feed', 'Thr_feed', 'His_feed', 'Asp_basal', 'Orn_basal', 'Folic acid_basal', 'Val_basal'],
            }
        },

    'galactosylation_14': {
        'randomforest': {
            '_fs1': ['pH', 'Pantothenic  acid_basal', 'Cu_feed', 'D-glucose_feed', 'DO', 'Ca_basal', 'Riboflavin_feed', 'Zn_basal', 'feed %', 'Thr_feed', 'K_basal', 'His_feed', 'Na_feed', 'feed vol', 'His_basal', 'Folic acid_feed', 'Fe_basal'],
            '_sfs': ['feed vol',
              'His_feed',
              'K_basal',
              'DO',
              'Thr_feed',
              'Leu_basal',
              'pH',
              'Arg_basal',
              'Riboflavin_feed',
              'Nicotinamide_basal',
              'Asn_basal',
              'Asp_basal',
              'Biotin_basal',
              'Ca_basal',
              'Choline_basal',
              'Cu_basal',
              'Ca_feed'],

            },
        'plsr': {'_sfs': ['Riboflavin_basal',
          'Riboflavin_feed',
          'feed %',
          'pH',
          'Leu_feed',
          'Choline_basal',
          'feed vol',
          'DO',
          'Pro_basal',
          'Na_basal',
          'Met_basal']},
        'lasso': {
            '_fs1': ['pH', 'Riboflavin_basal', 'Cu_feed', 'DO', 'Na_feed', 'feed vol', 'Asp_basal', 'Riboflavin_feed', 'Thr_feed', 'feed %', 'Orn_basal', 'His_feed', 'Folic acid_basal', 'K_feed', 'Val_basal', 'Tyr_basal', 'Co_basal']
            }
        },
    }

yvar_list_dict = {
0: ['Titer (mg/L)_14',
    'mannosylation_14',
    'fucosylation_14',
    'galactosylation_14',
    'G0_14',
    'G0F_14',
    'G1_14',
    'G1Fa_14',
    'G1Fb_14',
    'G2_14',
    'G2F_14',
    'Other_14'
    ],
    }


yvar_sublist_sets = [
    ['Titer (mg/L)_14', 'mannosylation_14', 'fucosylation_14', 'galactosylation_14'], 
    ['G0_14', 'G0F_14', 'G1_14', 'G1Fa_14'],
    ['G1Fb_14', 'G2_14', 'G2F_14', 'Other_14']
    ]

yvar_list_key = ['Titer (mg/L)_14', 'mannosylation_14', 'fucosylation_14', 'galactosylation_14']

common_xvars_dict = {
    (0,1): ['Arg',
     'Asn',
     'Asp',
     'Biotin',
     'Ca',
     'Choline',
     'Co',
     'Cu',
     'Cyanocobalamin',
     'Fe',
     'Folic acid',
     'Glu',
     'His',
     'Ile',
     'K',
     'Leu',
     'Lys',
     'Met',
     'Mg',
     'Na',
     'Nicotinamide',
     'Orn',
     'P',
     'Pantothenic  acid',
     'Phe',
     'Pro',
     'Pyridoxine',
     'Riboflavin',
     'Ser',
     'Thr',
     'Trp',
     'Tyr',
     'Val',
     'Zn']
    }

#%% MODEL PARAMETERS

model_cmap={'randomforest':'r', 'plsr':'b', 'lasso':'g'}

model_params = {
'X1Y0':{
'randomforest': {
    'Titer (mg/L)_14': [{'model_type': 'randomforest', 'n_estimators': 40}],
    'mannosylation_14': [{'model_type': 'randomforest', 'n_estimators': 40}],
    'fucosylation_14': [{'model_type': 'randomforest', 'n_estimators': 120}],
    'galactosylation_14': [{'model_type': 'randomforest', 'n_estimators': 40}],
    },
'plsr' : {
    'Titer (mg/L)_14': [{'model_type': 'plsr', 'n_components':10}],
    'mannosylation_14': [{'model_type': 'plsr', 'n_components':10}],
    'fucosylation_14': [{'model_type': 'plsr', 'n_components':11}],
    'galactosylation_14': [{'model_type': 'plsr', 'n_components':11}],
    },
'lasso': {
    'Titer (mg/L)_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':5}],
    'mannosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'fucosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'galactosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    }
},

'X0Y0_avg':{
'randomforest': {
    'Titer (mg/L)_14': [{'model_type': 'randomforest', 'n_estimators': 40}],
    'mannosylation_14': [{'model_type': 'randomforest', 'n_estimators': 140}],
    'fucosylation_14': [{'model_type': 'randomforest', 'n_estimators': 140}],
    'galactosylation_14': [{'model_type': 'randomforest', 'n_estimators': 60}],
    'G0_14': [{'model_type': 'randomforest', 'n_estimators': 120}],
    'G0F_14': [{'model_type': 'randomforest', 'n_estimators': 80}],
    'G1_14': [{'model_type': 'randomforest', 'n_estimators': 180}],
    'G1Fa_14': [{'model_type': 'randomforest', 'n_estimators': 140}],
    'G1Fb_14': [{'model_type': 'randomforest', 'n_estimators': 140}],
    'G2_14': [{'model_type': 'randomforest', 'n_estimators': 180}],
    'G2F_14': [{'model_type': 'randomforest', 'n_estimators': 180}],
    'Other_14': [{'model_type': 'randomforest', 'n_estimators': 180}]    
    },
'plsr' : {
    'Titer (mg/L)_14': [{'model_type': 'plsr', 'n_components':4}],
    'mannosylation_14': [{'model_type': 'plsr', 'n_components':10}],
    'fucosylation_14': [{'model_type': 'plsr', 'n_components':10}],
    'galactosylation_14': [{'model_type': 'plsr', 'n_components':10}],
    'G0_14': [{'model_type': 'plsr', 'n_components':9}],
    'G0F_14': [{'model_type': 'plsr', 'n_components':8}],
    'G1_14': [{'model_type': 'plsr', 'n_components':10}],
    'G1Fa_14': [{'model_type': 'plsr', 'n_components':4}],
    'G1Fb_14': [{'model_type': 'plsr', 'n_components':4}],
    'G2_14': [{'model_type': 'plsr', 'n_components':8}],
    'G2F_14': [{'model_type': 'plsr', 'n_components':9}],
    'Other_14': [{'model_type': 'plsr', 'n_components':10}]
    },
'lasso': {
    'Titer (mg/L)_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':100}],
    'mannosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'fucosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'galactosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'G0_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'G0F_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.005}],
    'G1_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G1Fa_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'G1Fb_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'G2_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G2F_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'Other_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}]     
    }
},

'X1Y0_avg':{
'randomforest': {
    'Titer (mg/L)_14': [{'model_type': 'randomforest', 'n_estimators': 120}],
    'mannosylation_14': [{'model_type': 'randomforest', 'n_estimators': 160}],
    'fucosylation_14': [{'model_type': 'randomforest', 'n_estimators': 120}],
    'galactosylation_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G0_14': [{'model_type': 'randomforest', 'n_estimators': 20}],
    'G0F_14': [{'model_type': 'randomforest', 'n_estimators': 140}],
    'G1_14': [{'model_type': 'randomforest', 'n_estimators': 160}],
    'G1Fa_14': [{'model_type': 'randomforest', 'n_estimators': 20}],
    'G1Fb_14': [{'model_type': 'randomforest', 'n_estimators': 180}],
    'G2_14': [{'model_type': 'randomforest', 'n_estimators': 140}],
    'G2F_14': [{'model_type': 'randomforest', 'n_estimators': 80}],
    'Other_14': [{'model_type': 'randomforest', 'n_estimators': 120}]    
    },
'plsr' : {
    'Titer (mg/L)_14': [{'model_type': 'plsr', 'n_components':8}],
    'mannosylation_14': [{'model_type': 'plsr', 'n_components':8}],
    'fucosylation_14': [{'model_type': 'plsr', 'n_components':9}],
    'galactosylation_14': [{'model_type': 'plsr', 'n_components':8}],
    'G0_14': [{'model_type': 'plsr', 'n_components':8}],
    'G0F_14': [{'model_type': 'plsr', 'n_components':9}],
    'G1_14': [{'model_type': 'plsr', 'n_components':10}],
    'G1Fa_14': [{'model_type': 'plsr', 'n_components':11}],
    'G1Fb_14': [{'model_type': 'plsr', 'n_components':12}],
    'G2_14': [{'model_type': 'plsr', 'n_components':6}],
    'G2F_14': [{'model_type': 'plsr', 'n_components':8}],
    'Other_14': [{'model_type': 'plsr', 'n_components':5}]
    },
'lasso': {
    'Titer (mg/L)_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':50}],
    'mannosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'fucosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'galactosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'G0_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'G0F_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'G1_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G1Fa_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'G1Fb_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G2_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G2F_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'Other_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}]     
    }
},

'X1Y0_tier12':{
'randomforest': {
    'Titer (mg/L)_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'mannosylation_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'fucosylation_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'galactosylation_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G0_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G0F_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G1_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G1Fa_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G1Fb_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G2_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'G2F_14': [{'model_type': 'randomforest', 'n_estimators': 100}],
    'Other_14': [{'model_type': 'randomforest', 'n_estimators': 100}]    
    },
'plsr' : {
    'Titer (mg/L)_14': [{'model_type': 'plsr', 'n_components':5}],
    'mannosylation_14': [{'model_type': 'plsr', 'n_components':5}],
    'fucosylation_14': [{'model_type': 'plsr', 'n_components':5}],
    'galactosylation_14': [{'model_type': 'plsr', 'n_components':5}],
    'G0_14': [{'model_type': 'plsr', 'n_components':6}],
    'G0F_14': [{'model_type': 'plsr', 'n_components':7}],
    'G1_14': [{'model_type': 'plsr', 'n_components':4}],
    'G1Fa_14': [{'model_type': 'plsr', 'n_components':8}],
    'G1Fb_14': [{'model_type': 'plsr', 'n_components':7}],
    'G2_14': [{'model_type': 'plsr', 'n_components':7}],
    'G2F_14': [{'model_type': 'plsr', 'n_components':8}],
    'Other_14': [{'model_type': 'plsr', 'n_components':5}]
    },
'lasso': {
    'Titer (mg/L)_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':20}],
    'mannosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'fucosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'galactosylation_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'G0_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G0F_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'G1_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}],
    'G1Fa_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.1}],
    'G1Fb_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G2_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'G2F_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.01}],
    'Other_14': [{'model_type': 'lasso', 'max_iter':50000, 'alpha':0.05}]     
    }
}
}

